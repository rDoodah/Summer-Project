{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2 class="text-3xl font-bold text-blue-700 mb-4">My Account</h2>

    <div class="card mb-5 shadow-sm border-primary">
        <div class="card-header bg-gradient-to-r bg-info text-white fw-bold">
            Personal Information
        </div>
        <div class="card-body">
            <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Name:</strong> {{ learner.name }}</li>
                <li class="list-group-item"><strong>Username:</strong> {{ learner.username }}</li>
                <li class="list-group-item"><strong>Gender:</strong> {{ learner.gender }}</li>
                <li class="list-group-item"><strong>Age:</strong> {{ learner.age }}</li>
                <li class="list-group-item"><strong>Emergency Contact:</strong> {{ learner.emergency_contact }}</li>
                <li class="list-group-item"><strong>Current Grade:</strong> {{ learner.current_grade }}</li>
            </ul>
        </div>
    </div>

    <h3 class="text-2xl font-semibold text-blue-600 mb-3">My Booked Lessons</h3>
    {% if bookings %}
    <div class="table-responsive">
        <table class="table table-striped table-bordered align-middle">
            <thead class="table-primary">
                <tr>
                    <th>Lesson ID</th>
                    <th>Day</th>
                    <th>Time Slot</th>
                    <th>Grade Level</th>
                    <th>Coach</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for booking in bookings %}
                <tr>
                    <td>{{ booking.lesson.id }}</td>
                    <td>{{ booking.lesson.day_of_week }}</td>
                    <td>{{ booking.lesson.time_slot }}</td>
                    <td>{{ booking.lesson.grade_level }}</td>
                    <td>{{ booking.lesson.coach.name }}</td>
                    <td>
                        {% if booking.status == 'booked' %}
                            <span class="badge bg-warning text-dark">{{ booking.status | capitalize }}</span>
                        {% elif booking.status == 'attended' %}
                            <span class="badge bg-success">{{ booking.status | capitalize }}</span>
                        {% elif booking.status == 'cancelled' %}
                            <span class="badge bg-danger">{{ booking.status | capitalize }}</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if booking.status == 'booked' %}
                            <form method="POST" action="{{ url_for('cancel_booking', booking_id=booking.id) }}" style="display:inline;">
                                <button type="submit" class="btn btn-sm btn-danger">Cancel</button>
                            </form>
                        {% endif %}
                        {% if booking.status == 'attended' %}
                            <a href="{{ url_for('submit_review', booking_id=booking.id) }}" class="btn btn-sm btn-info">Leave Review</a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p class="text-blue-700">You have no bookings yet. <a href="{{ url_for('calendar') }}" class="link-primary">Book a lesson</a></p>
    {% endif %}
</div>
{% endblock %}
